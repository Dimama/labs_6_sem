# Лабораторная работа №4 по моделированию
## Постановка задачи

#### Слава Ктулху, линеаризацию можно не использовать, что весьма ощутимо облегчает лабу.

Эта лабораторная является усложненным вариантом третьей лабораторной. В 3-ей необходимо было решить так называемую стационарную задачу - т.е. найти уже установившуюся температуру на всей длине стержня. В этой работе появляется зависимость от времени - необходимо как бы проследить весь процесс нагрева стержня. На выходе нужно построить график с изолиниями: каждая линия соответствует нагреву стержня в определенный момент времени.

![](/assets/l3_example.png)

Исходные данные:
* l = 10см (Длина стержня)
* R = 0.5см (Радиус стержня)
* Tenv = 300К (Температура окружающей среды)
* F0 = 100 Вт / (см^2 * К) (Плотность теплового потока)
* α0 = 1e-2  Вт / (см^2 * К) (Коэффициент теплоотдачи в начале стержня)
* αN = 0.9e-2  Вт / (см^2 * К) (Коэффициент теплоотдачи в конце стержня)

Также необходимо самостоятельно найти зависимости объемной теплоемкости C(T) и коэффициента теплопроводности k(T) от температуры для какого-нибудь материала. Я брал данные для вольфрама (ниже будет табличка)

_Замечание. Для коэффициента теплопроводности может использоваться как `k`, так и `λ`, я использую `k`, потому что мне так проще._

Исходное уравнение выглядит следующим образом:

![](http://latex.codecogs.com/gif.latex?C(T)\frac{\partial&space;T}{\partial&space;t}=\frac{\partial&space;}{\partial&space;x}\left&space;(&space;k(T)\frac{\partial&space;T}{\partial&space;x}&space;\right&space;)-\frac{2\alpha(x)}{R}T(x)&plus;\frac{2\alpha(x)}{R}*T_{env})

Исходные граничные условия не изменились:

![](/assets/2.png)

![](/assets/3.png)

## Концепция решения

Функция, производящая вычисления, будет иметь два вложенных цикла. Внешний цикл - по времени, итогом каждой его итерации будет массив значений T(x) в данный момент времени. Во внутреннем цикле методом простых итераций будет находиться этот самый массив T(x). 
 * Внешний цикл
 * * Внутренний цикл 
 * * Вычисляем граничные условия
 * * Вычисляем массивы коэффициентов для прогонки
 * * Выполняем прогонку и получаем новый массив `T(x)`
 * * Выход из цикла, если `max|T(x) - T_предыдущее(x)|/T(x) < ε` - т.е. находим максимально изменившийся элемент, и смотрим, насколько велико это изменение
 * Добавляем в решение очередной массив `T(x)`
 * Выход из цикла, если `max|T(x) - T_предыдущее(x)|/T(x) < ε` - т.е. завершаем вычисления, если нагрев настолько замедлился, что максимальное изменение температуры за шаг времени достаточно мало
 
 ## Теплоемкость и теплопроводность
 
 Необходимо выбрать какой-нибудь реальный материал и использовать данные для него.
 В отличие от 3 лабораторной, здесь коэффициент теплопроводности `k` зависит от температуры, а не напрямую от координаты. Работа предполагает два варианта задания теплопроводности:
 
 В виде функции: ![](http://latex.codecogs.com/gif.latex?k(T)&space;=&space;k_0*\left(\frac{T}{\theta}\right)^{m};\theta=300K). Коэффициенты `k0` и `m` надо как-нибудь подобрать, чтобы они соответствовали выбранному материалу. По мне это все отдает шаманством, и я это не использовал.
 
 В виде таблицы: при некотором желании несложно нагуглить таблицы теплопроводности и теплоемкости для нужного материала. Я выбрал вольфрам; другой неплохой вариант - сапфировый стержень, но найти данные для него - задача сомнительной выполнимости.
 
 _Важно: нужна именно объемная теплоемкость. В таблицах в основном дается массовая теплоемкость с размерностью Дж/(кг*К). Соответственно для получения объемной теплоемкости надо массовую теплоемкость умножить на плотность. Также важно не перепутать размерности и получить теплоемкость на кубический сантиметр, а не кубический метр (чтобы сошлись все размерности в уравнении)._
 
 Соответсвенно, когда нам надо посчитать коэффициент для определенной температуры, мы просто интерполируем данные из таблицы, как делали это во второй лабораторной.

_Данные для вольфрама._

|T, K |C, Дж/(см^3*К)|k, Вт/(см*К)|
|-----|------|-----|
|300  |2.544 |0.163|
|400  |2.615 |0.156|
|500  |2.656 |0.146|
|600  |2.689 |0.137|
|700  |2.717 |0.130|
|800  |2.748 |0.124|
|900  |2.783 |0.120|
|1000 |2.817 |0.117|
|1200 |2.893 |0.114|
|1400 |2.977 |0.111|
|1600 |3.070 |0.110|
|1800 |3.124 |0.109|
|2000 |3.270 |0.108|
|2200 |3.381 |0.107|
|2400 |3.502 |0.107|
|2600 |3.640 |0.107|
|2800 |3.792 |0.109|
|3000 |3.968 |0.108|
 
 ## Разностная схема и коэффициенты для прогонки
 
 _Замечание. Галочкой сверху обозначается, что переменная берется в следующий момент времени, соответственно, без галочки - в предыдущий момент времени:_
 ![](http://latex.codecogs.com/gif.latex?y_n&space;=&space;y(x_n,&space;t_m);\widehat{y_n}&space;=&space;y(x_n,&space;t_{m&plus;1}))
 
 Как и в предыдущей работе, для получения разностной схемы, используем интегро-интерполяционный метод, однако здесь интегрируем на ячейке по двум переменным: по координате `x` и по времени `t`.
 
 ![](http://latex.codecogs.com/gif.latex?\int_{x_{n-1/2}}^{x_{n&plus;1/2}}dx\int_{t_m}^{t_{m&plus;1}}C(T)\frac{\partial&space;T}{\partial&space;t}dt=\int_{t_m}^{t_{m&plus;1}}dt\int_{x_{n-1/2}}^{x_{n&plus;1/2}}\left&space;(\frac{\partial&space;}{\partial&space;x}\left&space;(&space;k(T)\frac{\partial&space;T}{\partial&space;x}&space;\right&space;)-\frac{2\alpha(x)}{R}T(x)&plus;\frac{2\alpha(x)}{R}*T_{env}\right&space;))
 
Для начала левую часть проинтегрируем по времени (обратите внимание, что `dt` там сокращаются). Правую часть проинтегрируем по `x` - фактически, мы уже сделали это в 3 лабораторной, поэтому воспользуемся результатами оттуда:

![](http://latex.codecogs.com/gif.latex?\int_{x_{n-1/2}}^{x_{n&plus;1/2}}\widehat{C}(\widehat{y}-y)dx=\int_{t_m}^{t_{m&plus;1}}\left(X_{n-1/2}\frac{y_{n-1}-y_n}{h}-X_{n&plus;1/2}\frac{y_n-y_{n&plus;1}}{h}-p_nhy_n&plus;f_nh\right)dt)

Теперь проинтегрируем по оставшимся переменным. Слева используем метод средних прямоугольников. Справа возьмем значение не в середине интервала, а в следующий момент времени `t_m+1`.

![](http://latex.codecogs.com/gif.latex?\widehat{C_n}(\widehat{y_n}-y_n)h=\tau\widehat{X_{n-1/2}}\frac{\widehat{y_{n-1}}-\widehat{y_n}}{h}-\tau\widehat{X_{n&plus;1/2}}\frac{\widehat{y_n}-\tau\widehat{y_{n&plus;1}}}{h}-\tau&space;p_nh\widehat{y_n}&plus;\tau&space;f_nh)

_`τ` - шаг по времени._

Преобразуем к виду, подходящему для прогонки, то есть:

![](http://latex.codecogs.com/gif.latex?\widehat{A_n}\widehat{y_{n-1}}-\widehat{B_n}\widehat{y_n}&plus;\widehat{D_n}\widehat{y_{n&plus;1}}=-\widehat{F_n})

_Буквы немного отличаются от тех, что предыдущей работе, это из-за наличия теплоемкости, которая обозначается буквой `C`. Галочки, как и раньше, обозначают, что переменные берутся в новый момент времени._

![](http://latex.codecogs.com/gif.latex?\widehat{A_n}&space;=&space;\tau\frac{X_{n-1/2}}{h})

![](http://latex.codecogs.com/gif.latex?\widehat{D_n}&space;=&space;\tau\frac{X_{n&plus;1/2}}{h})

![](http://latex.codecogs.com/gif.latex?\widehat{B_n}=\widehat{A_n}&plus;\widehat{D_n}&plus;p_nh\tau&plus;\widehat{C_n}h)

![](http://latex.codecogs.com/gif.latex?\widehat{F_n}=\widehat{C_n}hy_n&plus;f_nh\tau)

..где:

![](http://latex.codecogs.com/gif.latex?\widehat{X_{n-1/2}}=\frac{\widehat{k_{n-1}}&plus;\widehat{k_n}}{2};\widehat{X_{n&plus;1/2}}=\frac{\widehat{k_n}&plus;\widehat{k_{n&plus;1}}}{2})

![](http://latex.codecogs.com/gif.latex?\widehat{k_n}=k(\widehat{T_n});\widehat{T_n}=\widehat{T}(x_n))

![](http://latex.codecogs.com/gif.latex?p_n=\frac{2\alpha(x_n)}{R})

![](http://latex.codecogs.com/gif.latex?f_n=\frac{2\alpha(x_n)}{R}T_{env})



