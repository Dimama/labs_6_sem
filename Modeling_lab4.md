# Лабораторная работа №4 по моделированию
## Постановка задачи

#### Слава Ктулху, линеаризацию можно не использовать, что весьма ощутимо облегчает лабу.

Эта лабораторная является усложненным вариантом третьей лабораторной. В 3-ей необходимо было решить так называемую стационарную задачу - т.е. найти уже установившуюся температуру на всей длине стержня. В этой работе появляется зависимость от времени - необходимо как бы проследить весь процесс нагрева стержня. На выходе нужно построить график с изолиниями: каждая линия соответствует нагреву стержня в определенный момент времени.

![](/assets/l3_example.png)

Исходные данные:
* l = 10см (Длина стержня)
* R = 0.5см (Радиус стержня)
* Tenv = 300К (Температура окружающей среды)
* F0 = 100 Вт / (см^2 * К) (Плотность теплового потока)
* α0 = 1e-2  Вт / (см^2 * К) (Коэффициент теплоотдачи в начале стержня)
* αN = 0.9e-2  Вт / (см^2 * К) (Коэффициент теплоотдачи в конце стержня)

Также необходимо самостоятельно найти зависимости объемной теплоемкости C(T) и коэффициента теплопроводности k(T) от температуры для какого-нибудь материала. Я брал данные для вольфрама (ниже будет табличка)

_Замечание. Для коэффициента теплопроводности может использоваться как `k`, так и `λ`, я использую `k`, потому что мне так проще._

Исходное уравнение выглядит следующим образом:

![](http://latex.codecogs.com/gif.latex?C(T)\frac{\partial&space;T}{\partial&space;t}=\frac{\partial&space;}{\partial&space;x}\left&space;(&space;k(T)\frac{\partial&space;T}{\partial&space;x}&space;\right&space;)-\frac{2\alpha(x)}{R}T(x)&plus;\frac{2\alpha(x)}{R}*T_{env})

Исходные граничные условия не изменились:

![](/assets/2.png)

![](/assets/3.png)

## Концепция решения

Функция, производящая вычисления, будет иметь два вложенных цикла. Внешний цикл - по времени, итогом каждой его итерации будет массив значений T(x) в данный момент времени. Во внутреннем цикле методом простых итераций будет находиться этот самый массив T(x). 
 * Внешний цикл
 * * Внутренний цикл 
 * * Вычисляем граничные условия
 * * Вычисляем массивы коэффициентов для прогонки
 * * Выполняем прогонку и получаем новый массив `T(x)`
 * * Выход из цикла, если `max|T(x) - T_предыдущее(x)|/T(x) < ε` - т.е. находим максимально изменившийся элемент, и смотрим, насколько велико это изменение
 * Добавляем в решение очередной массив `T(x)`
 * Выход из цикла, если `max|T(x) - T_предыдущее(x)|/T(x) < ε` - т.е. завершаем вычисления, если нагрев настолько замедлился, что максимальное изменение температуры за шаг времени достаточно мало
 
 ### Разностная схема и коэффициенты для прогонки
 
 Как и в предыдущей работе, для получения разностной схемы, используем интегро-интерполяционный метод, однако здесь интегрируем на ячейке по двум переменным: по координате `x` и по времени `t`.
 
 ![](http://latex.codecogs.com/gif.latex?\int_{x_{n-1/2}}^{x_{n&plus;1/2}}dx\int_{t_m}^{t_{m&plus;1}}C(T)\frac{\partial&space;T}{\partial&space;t}dt=\int_{t_m}^{t_{m&plus;1}}dt\int_{x_{n-1/2}}^{x_{n&plus;1/2}}\left&space;(\frac{\partial&space;}{\partial&space;x}\left&space;(&space;k(T)\frac{\partial&space;T}{\partial&space;x}&space;\right&space;)-\frac{2\alpha(x)}{R}T(x)&plus;\frac{2\alpha(x)}{R}*T_{env}\right&space;))
 
